geom_bar(aes(y = ..count../sum(..count..))) +
ggtitle("Répartition sexe") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x = sexe, fill = sexe)) +
geom_bar(aes(y = ..count../sum(..count..))) +
ggtitle("Répartition sexe") +
labs(y = "Percent", fill="day") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x = sexe, fill = sexe)) +
geom_bar(aes(y = ..count../sum(..count..))) +
ggtitle("Répartition sexe") +
labs(y = "Percent", fill=sexe) +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x = sexe, fill = sexe)) +
geom_bar(aes(y = ..count../sum(..count..))) +
ggtitle("Répartition sexe") +
labs(y = "Percent", fill="Sexe") +
# xlab(" ") +
ylab("Proportion
ggplot(global_acc, aes(x = sexe, fill = sexe)) +
geom_bar(aes(y = ..count../sum(..count..))) +
ggtitle("Répartition sexe") +
labs(y = "Percent", fill="Sexe") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x = sexe, fill = sexe)) +
geom_bar(aes(y = ..count../sum(..count..))) +
ggtitle("Répartition sexe") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x = sexe, fill = sexe)) +
geom_bar(aes(y = ..count../sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ggtitle("Répartition sexe") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x= grav,  group=sexe)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -.5) +
labs(y = "Percent", fill="Grav") +
facet_grid(~sexe) +
scale_y_continuous(labels = scales::percent)
table(global_acc$grav)
ggplot(global_acc, aes(x= grav,  group=sexe)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -2) +
labs(y = "Proportion", fill="Grav") +
facet_grid(~sexe) +
scale_y_continuous(labels = scales::percent
ggplot(global_acc, aes(x = sexe, fill = sexe)) +
geom_bar(aes(y = ..count../sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ggtitle("Répartition sexe") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc) +
aes(x = sexe,stat="count") +
geom_histogram(fill ="orange", colour = "black", binwidth = 2) +
ggtitle("Répartition sexe") +
xlab("sexe") +
ylab("Effectifs")
ggplot(global_acc, aes(x = sexe, fill = sexe)) +
geom_bar(aes(y = ..count../sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ggtitle("Répartition sexe") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x= grav,  group=sexe)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -2) +
labs(y = "Proportion", fill="Grav") +
facet_grid(~sexe) +
scale_y_continuous(labels = scales::percent)
ggplot(global_acc, aes(x= grav,  group=sexe)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -2) +
labs(y = "Proportion", fill="Gravité") +
facet_grid(~sexe) +
scale_y_continuous(labels = scales::percent)
ggplot(global_acc, aes(x = ~, fill = )) +
geom_bar(aes(y = ..count../sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ggtitle("Répartition") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x = ~, fill = )) +
geom_bar(aes(y = ..count../sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ggtitle("Répartition") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x = sexe , fill =sexe )) +
geom_bar(aes(y = ..count../sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ggtitle("Répartition") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x= sexe,  group=grav)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -2) +
labs(y = "Proportion", fill="Gravité") +
facet_grid(~sexe) +
scale_y_continuous(labels = scales::percent)
ggplot(global_acc, aes(x= sexe,  group=grav)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -2) +
labs(y = "Proportion", fill="Gravité") +
facet_grid(~grav) +
scale_y_continuous(labels = scales::percent)
ggplot(global_acc, aes(x= sexe,  group=grav)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -2) +
labs(y = "Proportion", fill=sexe) +
facet_grid(~grav) +
scale_y_continuous(labels = scales::percent)
ggplot(global_acc, aes(x= sexe,  group=grav)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -2) +
labs(y = "Proportion", fill="Sexe") +
facet_grid(~grav) +
scale_y_continuous(labels = scales::percent)
ggplot(global_acc, aes(x= sexe,  group=grav)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = 1) +
labs(y = "Proportion", fill="Sexe") +
facet_grid(~grav) +
scale_y_continuous(labels = scales::percent)
colors<-c("blue","lightgreen","darkred")
pie(table(global_acc$sexe),col=colors,main="Répartition sexe",
labels=round(table(global_acc$sexe)/nrow(global_acc)*100,digits=3))
legend("bottomleft", xpd = TRUE, legend = unique(global_acc$sexe),fill=colors)
colors<-c("blue","red","darkred")
pie(table(global_acc$sexe),col=colors,main="Répartition sexe",
labels=round(table(global_acc$sexe)/nrow(global_acc)*100,digits=3))
legend("bottomleft", xpd = TRUE, legend = unique(global_acc$sexe),fill=colors)
table(global_acc$sexe)
table(global_acc$sexe)
prop.table(global_acc$sexe)
prop.table(global_acc$sexe)
table(global_acc$sexe)
prop.table(table(global_acc$sexe))
ggplot(global_acc, aes(x = sexe , fill =sexe )) +
geom_bar(aes(y = ..count../sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ggtitle("Répartition") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x = sexe , fill =sexe )) +
geom_bar(aes(y = ..count../sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ggtitle("Répartition") +
# xlab(" ") +
ylab("Proportion")
colors<-c("blue","red","darkred")
pie(table(global_acc$sexe),col=colors,main="Répartition sexe",
labels=round(table(global_acc$sexe)/nrow(global_acc)*100,digits=3))
legend("bottomleft", xpd = TRUE, legend = unique(global_acc$sexe),fill=colors)
ggplot(global_acc, aes(x = sexe , fill =sexe )) +
geom_bar(aes(y = ..count../sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ggtitle("Répartition") +
# xlab(" ") +
ylab("Proportion")
ggplot(global_acc, aes(x= sexe,  group=grav)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = 1) +
labs(y = "Proportion", fill="Sexe") +
facet_grid(~grav) +
scale_y_continuous(labels = scales::percent)
library("corrplot") # corrélation
library("ggplot2") # data visualisation
library("forcats") # factor manipulation
library("dplyr") # dataset manipulation
library("FactoMineR")# factorisation
library("Factoshiny") # ACM Intérface API
eig.val <- res.mca$eig
barplot(eig.val[, 2],
names.arg = 1:nrow(eig.val),
main = "Variances Explained by Dimensions (%)",
xlab = "Principal Dimensions",
ylab = "Percentage of variances",
col ="steelblue")
lines(x = 1:nrow(eig.val), eig.val[, 2],
type = "b", pch = 19, col = "red")
res.mca<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=T,na.method="average")
individus_2017_alldata <- read.csv(file ="data/individus_2017_alldata.csv", header = TRUE, sep = ",",encoding="UTF-8")
View(individus_2017_alldata)
View(individus_2017_alldata)
individus_2017_alldata[, 1]  <- as.numeric(individus_2017_alldata[, 1])
View(individus_2017_alldata)
individus_2017_alldata <- read.csv(file ="data/individus_2017_alldata.csv", header = TRUE, sep = ",",encoding="UTF-8",as.is = 1)
View(individus_2017_alldata)
options(scipen=999)
View(individus_2017_alldata)
global_acc_f<-select(individus_2017_alldata,Num_Acc,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu,choc,prof,plan,surf,lum,agg,int,zone,cat_vehic,meteo,collision,cat_route)
res.mca<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=T,na.method="average")
eig.val <- res.mca$eig
barplot(eig.val[, 2],
names.arg = 1:nrow(eig.val),
main = "Variances Explained by Dimensions (%)",
xlab = "Principal Dimensions",
ylab = "Percentage of variances",
col ="steelblue")
lines(x = 1:nrow(eig.val), eig.val[, 2],
type = "b", pch = 19, col = "red")
dimdesc(res.mca)
summary.MCA(res.mca,ncp=Inf,nbelements = Inf)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=F,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = F)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=F,na.method="average",ncp=5)
res.cah<-HCPC(res.mca_cah,consol = F)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=F,na.method="average",ncp=2)
res.cah<-HCPC(res.mca_cah,consol = F)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=F,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = T)
res.cah<-HCPC(res.mca_cah,consol = F)
coord<-as.data.frame(res.mca$ind$coord[,1:11])
res.cah<-HCPC(coord,consol = F)
coord<-as.data.frame(res.mca$ind$coord[,1:11])
res.mca<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=T,na.method="average")
coord<-as.data.frame(res.mca$ind$coord[,1:11])
coord<-as.data.frame(res.mca$ind$coord[,1:5])
View(coord)
View(coord)
coord<-as.data.frame(res.mca$ind$coord[,1:8])
coord<-as.data.frame(res.mca$ind$coord[,1:5])
coord<-as.data.frame(res.mca$ind$coord[,1:5])
res.cah<-HCPC(coord,consol = F)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=F,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = F)
res.cah<-HCMA(res.mca_cah,consol = F)
res.cah<-HCMA(res.mca_cah,consol = F)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=F,na.method="average",ncp=13)
res.cah<-HCMA(res.mca_cah,consol = F)
res.cah<-HCPC(res.mca_cah,consol = F)
res.cah<-HCPC(res.mca_cah,consol = F,nb.clust=0)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=F,na.method="average",ncp=13)
View(res.mca_cah)
View(res.mca_cah)
res.cah<-HCPC(res.mca_cah,consol = F,nb.clust=0)
res.cah<-HCPC(res.mca_cah,consol = F,nb.clust=0)
summary.MCA(res.mca_cah,ncp=Inf,nbelements = Inf)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=F,na.method="average",ncp=13)
summary.MCA(res.mca_cah,ncp=Inf,nbelements = Inf)
res.cah<-HCPC(res.mca_cah,consol = F,max = 3)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=F,na.method="average",ncp=20)
View(global_acc_f)
View(global_acc_f)
global_acc_f2<-select(individus_2017_alldata,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu,choc,prof,plan,surf,lum,agg,int,zone,cat_vehic,meteo,collision,cat_route)
res.mca_cah<-MCA(global_acc_f2,quali.sup=1,graph=F,na.method="average",ncp=20)
res.cah<-HCPC(res.mca_cah,consol = F,max = 3)
global_acc_f2<-select(individus_2017_alldata,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu)
res.mca_cah<-MCA(global_acc_f2,quali.sup=1,graph=F,na.method="average",ncp=20)
res.cah<-HCPC(res.mca_cah,consol = F,max = 3)
global_acc_f2<-select(individus_2017_alldata,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu)
View(global_acc_f2)
View(global_acc_f2)
global_acc_f2<-select(individus_2017_alldata,grav,sexe,groupe_age)
res.mca_cah<-MCA(global_acc_f2,graph=F,na.method="NA",ncp=20)
res.cah<-HCPC(res.mca_cah,consol = F,max = 3)
lev<-levels(global_acc_f2)
levels(global_acc_f2)
#global_acc_f<-select(individus_2017_alldata,Num_Acc,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu,choc,prof,plan,surf,lum,agg,int,zone,cat_vehic,meteo,collision,cat_route)
res.mca_cah<-MCA(global_acc_f,graph=F,na.method="average",ncp=13)
#global_acc_f<-select(individus_2017_alldata,Num_Acc,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu,choc,prof,plan,surf,lum,agg,int,zone,cat_vehic,meteo,collision,cat_route)
res.mca_cah<-MCA(global_acc_f,graph=F,na.method="average",ncp=13)
global_acc_f<-select(individus_2017_alldata,Num_Acc,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu,choc,prof,plan,surf,lum,agg,int,zone,cat_vehic,meteo,collision,cat_route)
#global_acc_f<-select(individus_2017_alldata,Num_Acc,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu,choc,prof,plan,surf,lum,agg,int,zone,cat_vehic,meteo,collision,cat_route)
res.mca_cah<-MCA(global_acc_f,graph=F,na.method="average",ncp=13)
#global_acc_f<-select(individus_2017_alldata,Num_Acc,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu,choc,prof,plan,surf,lum,agg,int,zone,cat_vehic,meteo,collision,cat_route)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=T,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = F,max = 5)
length(global_acc_f$grav)
sapply(global_acc_f, length)
library(ade4)
res.mca_cah <- dudi.acm(global_acc_f[,2:ncol(global_acc_f)], scannf = FALSE, nf = 13)
md <- dist.dudi(res.mca_cah)
dist.dudi(res.mca_cah)
md <- dist.dudi(acm)
View(global_acc_f)
View(global_acc_f)
res.mca_cah <- dudi.acm(global_acc_f[,2:ncol(global_acc_f)], scannf = FALSE, nf = 5)
md <- dist.dudi(res.mca_cah)
View(individus_2017_alldata)
View(individus_2017_alldata)
View(global_acc_f)
View(global_acc_f)
global_acc_f2<-select(individus_2017_alldata,grav,sexe,groupe_age,)
global_acc_f2<-select(individus_2017_alldata,grav,sexe,groupe_age)
res.mca_cah <- dudi.acm(global_acc_f2, scannf = FALSE, nf = 5)
md <- dist.dudi(res.mca_cah)
global_acc_f2=global_acc_f2[1:1000,]
res.mca_cah <- dudi.acm(global_acc_f2, scannf = FALSE, nf = 5)
md <- dist.dudi(res.mca_cah)
res.mca_cah<-MCA(global_acc_f2,graph=T,na.method="average",ncp=10)
res.cah<-HCPC(res.mca_cah,consol = F,max = 5)
global_acc_f<-select(individus_2017_alldata,Num_Acc,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu,choc,prof,plan,surf,lum,agg,int,zone,cat_vehic,meteo,collision,cat_route)
res.mca<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=T,na.method="average")
global_acc_f2<-sample(global_acc_f,1000)
global_acc_f2<-sample(global_acc_f,10)
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 10), ]
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 10000), ]
View(global_acc_f2)
View(global_acc_f2)
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=T,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = F,max = 5)
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 1000), ]
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=T,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = F,max = 5)
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=T,na.method="average",ncp=5)
res.cah<-HCPC(res.mca_cah,consol = F,max = 5)
res.mca_cah <- dudi.acm(global_acc_f2, scannf = FALSE, nf = 5)
library(ade4)
individus_2017_alldata <- read.csv(file ="data/individus_2017_alldata.csv", header = TRUE, sep = ",",encoding="UTF-8")
global_acc_f<-select(individus_2017_alldata,Num_Acc,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu,choc,prof,plan,surf,lum,agg,int,zone,cat_vehic,meteo,collision,cat_route)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=T,na.method="average",ncp=10)
res.cah<-HCPC(res.mca_cah,consol = F,max = 5)
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 1000), ]
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 1000), ]
res.mca_cah <- dudi.acm(global_acc_f2[,2:ncol(global_acc_f2)], scannf = FALSE, nf = 5)
md <- dist.dudi(res.mca_cah)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=T,na.method="average",ncp=10)
res.cah<-HCPC(res.mca_cah,consol = F,max = 5)
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=T,na.method="average",ncp=10)
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=10)
res.cah<-HCPC(res.mca_cah,consol = F,max = 5)
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 5000), ]
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=10)
res.cah<-HCPC(res.mca_cah,consol = F)
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 10000), ]
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=10)
res.cah<-HCPC(res.mca_cah,consol = F)
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 7000), ]
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=10)
res.cah<-HCPC(res.mca_cah,consol = F)
res.mca_cah<-MCA(global_acc_f[,2:ncol(global_acc_f)],quali.sup=1,graph=T,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = F,max = 5)
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 7000), ]
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=T,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = F,max = 5)
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 5000), ]
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = F,max = 5)
> memory.limit()
memory.limit()
memory.limit(size=56000)
memory.limit(size=56000)
memory.limit()
memory.limit(size=16095)
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=Inf)
res.cah<-HCPC(res.mca_cah,consol = F)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=11)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
plot(res.cah, choice = "tree")
plot(res.cah, choice = "3D.map")
plot(res.cah, choice = "bar")
plot(res.cah, choice = "map")
global_acc_f2$cluster <- res.cah$data.clust$clust
View(global_acc_f2)
View(global_acc_f2)
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 5000), ]
help(dudi.acm)
res.mca_cah <- dudi.acm(global_acc_f2[,2:ncol(global_acc_f2)], scannf = FALSE, nf = 13)
md <- dist.dudi(res.mca_cah)
arbre <- hclust(md, method = "ward.D2")
plot(arbre, labels = FALSE, main = "Dendrogramme")
inertie <- sort(arbre$height, decreasing = TRUE)
plot(inertie[1:20], type = "s", xlab = "Nombre de classes", ylab = "Inertie")
plot(inertie[1:20], type = "s", xlab = "Nombre de classes", ylab = "Inertie")
points(c(2, 5, 8), inertie[c(2, 5, 8)], col = c("green3", "red3",
"blue3"), cex = 2, lwd = 3)
plot(inertie[1:20], type = "s", xlab = "Nombre de classes", ylab = "Inertie")
points(c(2, 11, 8), inertie[c(2, 11, 8)], col = c("green3", "red3",
"blue3"), cex = 2, lwd = 3)
lot(inertie[1:20], type = "s", xlab = "Nombre de classes", ylab = "Inertie")
points(c(2, 11, 8), inertie[c(2, 12, 8)], col = c("green3", "red3",
"blue3"), cex = 2, lwd = 3)
plot(inertie[1:20], type = "s", xlab = "Nombre de classes", ylab = "Inertie")
points(c(2, 12, 8), inertie[c(2, 12, 8)], col = c("green3", "red3",
"blue3"), cex = 2, lwd = 3)
plot(inertie[1:20], type = "s", xlab = "Nombre de classes", ylab = "Inertie")
points(c(2, 12, 9), inertie[c(2, 12, 9)], col = c("green3", "red3",
"blue3"), cex = 2, lwd = 3)
plot(inertie[1:20], type = "s", xlab = "Nombre de classes", ylab = "Inertie")
points(c(2, 10, 9), inertie[c(2, 10, 9)], col = c("green3", "red3",
"blue3"), cex = 2, lwd = 3)
lot(inertie[1:20], type = "s", xlab = "Nombre de classes", ylab = "Inertie")
points(c(2, 11, 9), inertie[c(2, 11, 9)], col = c("green3", "red3",
"blue3"), cex = 2, lwd = 3)
ypo <- cutree(arbre, 5)
par(mfrow = c(1, 2))
library(RColorBrewer)
s.class(acm$li, as.factor(typo), col = brewer.pal(5, "Set1"),
sub = "Axes 1 et 2")
s.class(acm$li, as.factor(typo), 3, 4, col = brewer.pal(5, "Set1"),
sub = "Axes 3 et 4")
par(mfrow = c(1, 2))
library(RColorBrewer)
s.class(res.mca_cah$li, as.factor(typo), col = brewer.pal(5, "Set1"),
sub = "Axes 1 et 2")
s.class(res.mca_cah$li, as.factor(typo), 3, 4, col = brewer.pal(5, "Set1"),
sub = "Axes 3 et 4")
typo <- cutree(arbre, 5)
par(mfrow = c(1, 2))
library(RColorBrewer)
s.class(res.mca_cah$li, as.factor(typo), col = brewer.pal(5, "Set1"),
sub = "Axes 1 et 2")
s.class(res.mca_cah$li, as.factor(typo), 3, 4, col = brewer.pal(5, "Set1"),
sub = "Axes 3 et 4")
A2Rplot(arbre, k = 5, boxes = FALSE, col.up = "gray50", col.down = brewer.pal(5,
"Dark2"), show.labels = FALSE)
install.packages("JLutils")
library(JLutils)
library(JLutils)
res.cah$hcpc$desc.var
res.cah$hcpc$desc.axes
res.cah$hcpc$desc.ind
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 5000), ]
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=11)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
res.cah$hcpc$desc.var
res.cah$hcpc$desc.axes
res.cah$hcpc$desc.ind
res.cah$hcpc$desc.var
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=5)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
#Partition
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 7000), ]
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
#Partition
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 4000), ]
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=13)
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=5)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=11)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
#Partition
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 2000), ]
View(global_acc_f2)
View(global_acc_f2)
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=4)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=2)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
#Partition
global_acc_f2<-global_acc_f[sample(nrow(global_acc_f), 5000), ]
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=2)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=4)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=11)
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=11)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
#Clusterisation
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=7)
res.mca_cah<-MCA(global_acc_f2[,2:ncol(global_acc_f2)],quali.sup=1,graph=F,na.method="average",ncp=13)
res.cah<-HCPC(res.mca_cah,consol = F,max = 10)
View(individus_2017_alldata)
CrossTable(individus_2017_alldata$utilisation_equipement_secu, individus_2017_alldata$cat_vehic)
library("corrplot") # corrélation
library("ggplot2") # data visualisation
library("forcats") # factor manipulation
library("dplyr") # dataset manipulation
library("kableExtra") # create nice html tables
library("stringi") # string manipulation
library("patchwork") # combine plots
library("FactoMineR")# factorisation
library("Factoshiny") # ACM Intérface API
CrossTable(individus_2017_alldata$utilisation_equipement_secu, individus_2017_alldata$cat_vehic)
#
install.packages("models")# A
library("models")
install.packages(models)# ACM Intérface API
install.packages(gmodels)# ACM Intérface API
install.packages("gmodels")# ACM Intérface API
library("models")
install.packages("gmodels")#
library("models")
library("gmodels")
CrossTable(individus_2017_alldata$utilisation_equipement_secu, individus_2017_alldata$cat_vehic)
#
global_acc_f<-select(individus_2017_alldata,Num_Acc,grav,sexe,groupe_age,catu,trajet,utilisation_equipement_secu,choc,prof,plan,surf,lum,agg,int,zone,cat_vehic,meteo,collision,cat_route)
